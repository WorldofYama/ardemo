
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>AR.js Hiro (Local)</title>

  <!-- ★ CDNではなくローカル（相対パス） -->
  ./aframe.min.js</script>
  ./aframe-ar.js</script>

  <style>html, body { margin:0; height:100%; background:#000; }</style>
</head>
<body>
  <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: true;">
    <a-marker preset="hiro">
      <a-box position="0 0.25 0" depth="0.5" height="0.5" width="0.5" color="#1e88e5"></a-box>
    </a-marker>
    <a-entity camera></a-entity>
  </a-scene>

  <!-- 任意：初期化ログ -->
  <script>
    const sceneEl = document.querySelector('a-scene');
    sceneEl.addEventListener('arReady', () => console.log('[AR.js] arReady'));
    sceneEl.addEventListener('renderstart', () => console.log('[A-Frame] renderstart'));
    window.addEventListener('error', (e) => console.error('[Error]', e.message, e.filename, e.lineno));
  </script>
  
<script>
  console.log('Inline JS OK');
  document.body.insertAdjacentHTML('beforeend',
    '<div style="position:fixed;top:8px;left:8px;color:#0f0;z-index:9999">JS動作OK</div>');
</script>

  
<script>
  // 動的に A-Frame と AR.js をロードして、成功/失敗をログ
  function addScript(src, name){
    return new Promise((resolve, reject)=>{
      const s = document.createElement('script');
      s.src = src;
      s.onload = () => { console.log(`[LOAD OK] ${name}`); resolve(); };
      s.onerror = (e) => { console.error(`[LOAD NG] ${name}`, e); reject(e); };
      document.head.appendChild(s);
    });
  }

  (async () => {
    try {
      await addScript('./aframe.min.js', 'aframe.min.js');
      await addScript('./aframe-ar.js', 'aframe-ar.js');
      console.log('AFR exists?', typeof AFRAME, AFRAME && AFRAME.VERSION);
      console.log('THREEx exists?', typeof THREEx);
    } catch(e) {
      console.error('Dynamic load failed:', e);
    }
  })();


</body>
</html>
